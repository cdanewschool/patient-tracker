<div data-role="page">

	<tabset>
	
		<tab heading="My Trackers" class="small" select="onTabSelect()" active="model.tabs['trackers'].active">
			
			<div style="margin-top:10px">
		    
		    	<div ng-show="!model.trackersFiltered || model.trackersFiltered.length==0" style="margin:20px;">
		    		You haven't added any {{model.selectedCondition?model.selectedCondition.name + ' ':''}}trackers yet. Get going!
		    	</div>
		    	
				<div class="trackers container" ng-if="(model.trackersFiltered = (model.trackers | filter:trackerAppliesToCondition)).length>=1">
					
					<div class="row alpha omega tracker" ng-repeat="tracker in model.trackersFiltered" ng-class="{maximized: model.tracker==tracker}">
						
						<div class="header" ng-class="{maximized: model.tracker==tracker}" ng-click="(tracker.records.length>1 ? navigation.viewTracker('tracker',tracker) : null)">
						
							<div class="col-xs-4 v-center title" style="padding-left:2px;padding-right:2px">
								<div>
									{{tracker.name}}
								</div>
				    		</div>
				    		
				    		<div class="col-xs-6 v-center text-center text-muted" ng-if="!tracker.valueSummary.values.length">
				    			<div><small><em>No data added yet!</em></small></div>
				    		</div>
				    		
					    	<div class="col-xs-4 v-center last" ng-if="tracker.valueSummary.values.length" style="padding-left:2px;padding-right:2px">
				    			
				    			<div ng-if="tracker.valueSummary.lastValue">
				    				<!-- arrow -->
				    				<div ng-if="tracker.valueSummary.values.length && tracker.valueSummary.values[0].length > 1" style="display:inline-block;vertical-align:middle">
					    				<span ng-if="tracker.valueSummary.values[0][tracker.valueSummary.values[0].length-2] < tracker.valueSummary.values[0][tracker.valueSummary.values[0].length-1]" class="glyphicon glyphicon-arrow-up"></span>
					    				<span ng-if="tracker.valueSummary.values[0][tracker.valueSummary.values[0].length-2] > tracker.valueSummary.values[0][tracker.valueSummary.values[0].length-1]" class="glyphicon glyphicon-arrow-down"></span>
					    			</div>
					    			<!-- last value -->
				    				<div style="display:inline-block;vertical-align:middle">
				    					<strong>{{tracker.valueSummary.lastValue.value}}</strong><br/>{{tracker.valueSummary.lastValue.unit}}
				    				</div>
				    			</div>
					    	</div>
					    	
					    	<div class="col-xs-2 v-center graph" ng-if="tracker.valueSummary.values.length" style="padding-left:5px;padding-right:5px;height:50%">
					    		<div>
					    			<sparkline ng-repeat="values in tracker.valueSummary.values" ng-if="tracker.type!=constants.TYPE_MEDICATION" data="{{values}}" sparkline-min="{{tracker.valueSummary.min}}" sparkline-max="{{tracker.valueSummary.max}}" sparkline-color="model.tracker==tracker?'fff':'333'"></sparkline>
					    		</div>
					    	</div>
					    	
					    	<div class="col-xs-2 v-center text-right" style="padding-left:2px;padding-right:2px">
					    		<div>
					    			<button type="button" class="btn btn-default btn-xs" ng-click="model.selectedTrackerId=tracker.code; navigation.showPopup('record'); $event.stopImmediatePropogation()">
										<span class="glyphicon glyphicon-plus"></span>
									</button>
					    		</div>
					    	</div>
					    	
						</div>
						
						<div ng-show="model.tracker==tracker" ng-switch on="model.tracker.type">
    						
    						<div ng-switch-when="vital" ng-show="model.tracker.records.length>1">
    							<tracker-chart records="model.tracker.records" timespans="model.timespans" y-axis-label="tracker.valueSummary.lastValue.unit" chart-type="tracker.name != 'Blood Pressure' ? 'line' : 'arearange'"></tracker-chart>
    						</div>
    						
    						<div ng-switch-when="medication" ng-show="model.tracker.records.length>1">
    							<tracker-chart records="model.tracker.records" timespans="model.timespans" y-axis-label="'Intake'" chart-type="'scatter'"></tracker-chart>
    						</div>
		    				
		    				<div ng-switch-when="tracker" ng-show="model.tracker.records.length>1">
    							<tracker-chart records="model.tracker.records" timespans="model.timespans" y-axis-label="tracker.valueSummary.lastValue.unit" chart-type="'line'"></tracker-chart>
    						</div>
    						
		    			</div>
					    	
					</div>
					
				</div>
				
		  	</div>
		  	
		</tab>
		
		<tab heading="Compare" class="small" active="model.tabs['compare'].active" ng-controller="CompareCtrl">
			
			<div ng-if="!compareModel.trackerSet" style="margin:20px;">
				
				<h4>Pick Trackers</h4>
				
			    <ul class="list-unstyled">
			    
			    	<li ng-repeat="tracker in compareModel.trackers">
			    		
			    		<div class="checkbox">
			    			
			    			<label>
			      				<input ng-model="tracker.selected" type="checkbox"> {{tracker.name}}
							</label>
						
						</div>
						
			    	</li>
			    
			    </ul>
		    
		    	<div>
		    		<button class="btn btn-primary" ng-click="viewSelection()">View</button>
		    	</div>
	
			</div>
			
			<div ng-if="compareModel.trackerSet" style="overflow-y:auto;">
				
				<div class="compare-list">
					
					<div class="row alpha omega tracker" ng-class="{even:$index%2==0,odd:$index%2==1}" ng-repeat="tracker in compareModel.trackerSet.trackers">
						
						<div class="compare-item" class="col-xs-12" style="padding-left:2px;padding-right:2px">
							<div>{{tracker.name}}</div>
							<tracker-chart-compare records="tracker.records" timespans="model.timespans"></tracker-chart-compare>
			    		</div>
					    	
					</div>
					
				</div>
				
				<div style="background-color:#000; padding: 5px">
		    		<button class="btn btn-primary" ng-click="compareModel.trackerSet=null">Pick Trackers</button>
		    	</div>
		    	
			</div>
			
		</tab>
		
		<tab heading="Settings" class="small" active="model.tabs['settings'].active">
			<tab-heading>
        		<i class="glyphicon glyphicon-cog"></i>
      		</tab-heading>
		</tab>
		
	</tabset>

</div>